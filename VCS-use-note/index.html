<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#222"><meta name="generator" content="Hexo 4.0.0"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png"><link rel="icon" type="image/png" sizes="32x32" href="/images/ico32x32.ico"><link rel="icon" type="image/png" sizes="16x16" href="/images/ico16x16.ico"><link rel="mask-icon" href="/images/logo.svg" color="#222"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic|Liu Jian Mao Cao:300,300italic,400,400italic,700,700italic|Shadows Into Light:300,300italic,400,400italic,700,700italic|Yeon Sung:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext"><link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css"><script id="hexo-configurations">var NexT=window.NexT||{},CONFIG={root:"/",scheme:"Mist",version:"7.5.0",exturl:!1,sidebar:{position:"left",width:300,display:"hide",offset:12,onmobile:!1},copycode:{enable:!1,show_result:!1,style:null},back2top:{enable:!0,sidebar:!1,scrollpercent:!0},bookmark:{enable:!1,color:"#222",save:"auto"},fancybox:!1,mediumzoom:!1,lazyload:!1,pangu:!1,algolia:{appID:"",apiKey:"",indexName:"",hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}},localsearch:{enable:!0,trigger:"auto",top_n_per_article:1,unescape:!1,preload:!1},path:"search.xml",motion:{enable:!0,async:!1,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}},translation:{copy_button:"Copy",copy_success:"Copied",copy_failure:"Copy failed"},sidebarPadding:40}</script><meta name="description" content="VCS的编译链接过程和一般c&#x2F;c++的过程类似，只是叫法有些区别。"><meta name="keywords" content="setup"><meta property="og:type" content="article"><meta property="og:title" content="VCS use note"><meta property="og:url" content="http:&#x2F;&#x2F;winter-leaf.github.io&#x2F;VCS-use-note&#x2F;index.html"><meta property="og:site_name" content="Leaf in winter"><meta property="og:description" content="VCS的编译链接过程和一般c&#x2F;c++的过程类似，只是叫法有些区别。"><meta property="og:locale" content="en"><meta property="og:updated_time" content="2019-12-21T10:35:35.863Z"><meta name="twitter:card" content="summary"><link rel="canonical" href="http://winter-leaf.github.io/VCS-use-note/"><script id="page-configurations">CONFIG.page={sidebar:"",isHome:!1,isPost:!0,isPage:!1,isArchive:!1}</script><title>VCS use note | Leaf in winter</title><noscript><style>.sidebar-inner,.use-motion .brand,.use-motion .collection-header,.use-motion .comments,.use-motion .menu-item,.use-motion .pagination,.use-motion .post-block,.use-motion .post-body,.use-motion .post-header{opacity:initial}.use-motion .site-subtitle,.use-motion .site-title{opacity:initial;top:initial}.use-motion .logo-line-before i{left:initial}.use-motion .logo-line-after i{right:initial}</style></noscript></head><body itemscope itemtype="http://schema.org/WebPage"><div class="container use-motion"><div class="headband"></div><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-container"><div class="site-meta"><div><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span> <span class="site-title">Leaf in winter</span><span class="logo-line-after"><i></i></span></a></div><h1 class="site-subtitle" itemprop="description">Do you see the wind?</h1></div><div class="site-nav-toggle"><div class="toggle" aria-label="Toggle navigation bar"><span class="toggle-line toggle-line-first"></span><span class="toggle-line toggle-line-middle"></span><span class="toggle-line toggle-line-last"></span></div></div></div><nav class="site-nav"><ul id="menu" class="menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-fw fa-home"></i> Home</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-fw fa-tags"></i> Tags</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-fw fa-th"></i> Categories</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i> Archives</a></li><li class="menu-item menu-item-search"><a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i> Search</a></li></ul></nav><div class="site-search"><div class="popup search-popup"><div class="search-header"><span class="search-icon"><i class="fa fa-search"></i></span><div class="search-input-container"> <input autocomplete="off" autocorrect="off" autocapitalize="none" placeholder="Searching..." spellcheck="false" type="text" id="search-input"></div><span class="popup-btn-close"><i class="fa fa-times-circle"></i></span></div><div id="search-result"></div></div><div class="search-pop-overlay"></div></div></div></header><div class="back-to-top"><i class="fa fa-arrow-up"></i> <span>0%</span></div><main class="main"><div class="main-inner"><div class="content-wrap"><div class="content"><div class="posts-expand"><article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en"><link itemprop="mainEntityOfPage" href="http://winter-leaf.github.io/VCS-use-note/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.jpeg"><meta itemprop="name" content="winter leaf"><meta itemprop="description" content="Batman, if you don't believe it then superman"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Leaf in winter"></span><header class="post-header"><h2 class="post-title" itemprop="name headline"> VCS use note</h2><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i></span> <span class="post-meta-item-text">Posted on</span> <time title="Created: 2019-12-14 14:15:23" itemprop="dateCreated datePublished" datetime="2019-12-14T14:15:23+08:00">2019-12-14</time></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-calendar-check-o"></i></span> <span class="post-meta-item-text">Edited on</span> <time title="Modified: 2019-12-21 18:35:35" itemprop="dateModified" datetime="2019-12-21T18:35:35+08:00">2019-12-21</time></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-folder-o"></i></span> <span class="post-meta-item-text">In</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/VCS/" itemprop="url" rel="index"><span itemprop="name">VCS</span></a></span></span></div></header><div class="post-body" itemprop="articleBody"><p>VCS的编译链接过程和一般c/c++的过程类似，只是叫法有些区别。</p><a id="more"></a><p>c/c++中，源文件(<em>.c, *.cpp)经过compile和link两个过程形成最终可执行文件。<br>VCS中，简单地类比，HDL源文件(</em>.vhd, *.v, *sv)经过analyze，elaborate，最终生成可执行文件simv。</p><h1 id="1-Analyzing-the-Design"><a href="#1-Analyzing-the-Design" class="headerlink" title="1. Analyzing the Design"></a>1. Analyzing the Design</h1><p>VCS根据源HDL文件使用语言不同，提供两个analyze的指令<strong><em>vhdlan</em></strong> 和 <strong><em>vlogan</em></strong>。<br>最终生成待连接文件，过程和c中的compile类似。如果是systemverilog，需要加上-sverilog选项。<br>实际上，这个过程更多的是为后续的准备工作。这个过程会生成一个AN.DB的数据包，用于后续编译连接工作。</p><h1 id="2-Elaborating-the-Design"><a href="#2-Elaborating-the-Design" class="headerlink" title="2. Elaborating the Design"></a>2. Elaborating the Design</h1><p>VCS的连接过程叫做elaborate，指令比较单一，仅是 vcs [-options] filename. 最终会生成simv可执行文件。<br>这个过程实际上比一般的连接工作要多一些。VCS本质上用的是C/C++来进行最终编译连接形成simv。那么对于HDL类型输入文件，<br>VCS就会有一个从HDL到C的翻译过程。换句话说，VCS在elaborate过程做的是:</p><ol><li>翻译HDL文件到C文件</li><li>将C文件编译形成二进制待连接文件</li><li>将二进制文件连接形成可执行文件simv</li></ol><p>所以在VCS的elaborate过程会生成一个csrc文件夹，用以存放上述产生的这些文件。</p><h1 id="3-Simulating-the-Design"><a href="#3-Simulating-the-Design" class="headerlink" title="3. Simulating the Design"></a>3. Simulating the Design</h1><p>这个过程仅是运行simv，没什么特别的。</p><h1 id="4-Build-flow"><a href="#4-Build-flow" class="headerlink" title="4. Build flow"></a>4. Build flow</h1><p>VCS文档中划分了两种建立过程，Two-step flow和Three-step flow。本质上其实是一种，只不过three-step是把two-step的第一步细分而已.<br>Two step = Compilation(Analyze+Elaborate) + Simulation<br>Three step = Analyze + Elaborate + Simulation</p><p>一般情况下，two-step就可以了。但如果要跨语言和使用外部提供的待连接文件，那就要用three-step。</p><h2 id="4-1-Two-step-flow"><a href="#4-1-Two-step-flow" class="headerlink" title="4.1 Two-step flow"></a>4.1 Two-step flow</h2><h3 id="compilation-Analyze-Elaborate"><a href="#compilation-Analyze-Elaborate" class="headerlink" title="compilation (Analyze + Elaborate)"></a>compilation (Analyze + Elaborate)</h3><blockquote><p>% vcs [compile_options] Verilog_files</p></blockquote><h3 id="Simulation"><a href="#Simulation" class="headerlink" title="Simulation"></a>Simulation</h3><blockquote><p>% simv [run_options]</p></blockquote><h2 id="4-2-Three-step-flow"><a href="#4-2-Three-step-flow" class="headerlink" title="4.2 Three-step flow"></a>4.2 Three-step flow</h2><p>Analysis <strong><em>(Always analyze Verilog/Systemverilog before VHDL.)</em></strong></p><blockquote><p>% vlogan [vlogan_options] file1.v file2.v<br>% vlogan -sverilog [vlogan_options] file1.sv file2.sv file3.sv<br>% vhdlan [vhdlan_options] file3.vhd file4.vhd<br><strong>注: 如果有vhdl文件, 那么要先编译它们, 并且编译顺序是从设计层级的底部向上, 走bottom-up路线.</strong></p></blockquote><p>Elaboration</p><blockquote><p>% vcs [elaboration_options] <strong>design_unit</strong><br>The design_unit can be one of the following:</p><ul><li>module<br>Verilog top module name.</li><li>entity<br>VHDL top entity name.</li><li>entity__archname<br>Name of the top entity and architecture to be simulated. By<br>default, archname is the most recently analyzed architecture.</li><li>cfgname<br>Name of the top-level event configuration to be simulated.</li></ul></blockquote><p>Simulation</p><blockquote><p>% simv [run_options]</p></blockquote><h2 id="4-3-Default-Time-Unit-and-Time-Precision"><a href="#4-3-Default-Time-Unit-and-Time-Precision" class="headerlink" title="4.3 Default Time Unit and Time Precision"></a>4.3 Default Time Unit and Time Precision</h2><p>verilog和systemverilog中的默认时间单位是1秒。默认的是时间精度也是1秒。<br>在vhdl中，没有默认时间这个概念，要用到时间，必须加上时间单位，比如: wait for 10.123123 ns;</p><h1 id="5-Commonly-used-options-in-analyze-step"><a href="#5-Commonly-used-options-in-analyze-step" class="headerlink" title="5. Commonly used options in analyze step"></a>5. Commonly used options in analyze step</h1><p>Using ‘vhdlan’ is similar, here we don’t describe it but only vlogan.</p><ul><li><p>-nc<br>Suppresses the Synopsys copyright message.</p></li><li><p>-q<br>Suppresses all vlogan messages.</p></li><li><p>-f filename<br>Specifies a file that contains a list of source files.<br>Note: The maximum line length in the specified file filename<br>must be less than 1024 characters. VCS truncates the line exceeding<br>this limit and issues a warning message.</p></li><li><p>-full64<br>Analyzes the design for 64-bit simulation.</p></li><li><p>-l filename<br>Specifies a log file where VCS records the analyzer messages.</p></li><li><p>-sverilog<br>Enables the analysis of SystemVerilog source code.</p></li><li><p>-timescale=time_unit/time_precision<br>This option enables you to specify the timescale for the source<br>files that do not contain ‘timescale compiler directive and<br>precede the source files that contain.<br>Do not include spaces when specifying the arguments to this option.</p></li><li><p>-v library_file<br>Specifies a Verilog library file to search for module definitions.</p></li><li><p>+define+macro<br>Defines a text macro. Test this definition in your Verilog source<br>code using the ‘ifdef compiler directive.</p></li><li><p>+libext+extension+<br>Specifies that VCS searches only for files with the specified file<br>name extensions in a library directory. You can specify more than<br>one extension, separating the extensions with the plus (+)<br>character. For example, +libext+.v+.V+ specifies searching<br>files with either the .v or .V extension in a library.</p></li><li><p>+incdir+directory<br>Specifies the directories that contain the files specified with the<br>‘include compiler directive. You can specify more than one<br>directory, separating each path name with the “+” character.</p></li><li><p>+systemverilogext+ext<br>Specifies a file name extension for SystemVerilog source files.<br><strong><em>If you use a different file name extension for the SystemVerilog part of your source code and you use this option, the –sverilog option will be omitted.</em></strong></p></li></ul><h1 id="6-Commonly-used-options-in-elaboration-step"><a href="#6-Commonly-used-options-in-elaboration-step" class="headerlink" title="6. Commonly used options in elaboration step"></a>6. Commonly used options in elaboration step</h1><p>使用文档中建议，在elaborate的过程中，可以先使用调试模式来elaborate以保证正确性，之后再切换到优化模式或者关掉调试模式。一般优化模式在跑测试回归的时候会使用。</p><p>The syntax to use <strong><em>vcs</em></strong> is as follows:</p><blockquote><p>% vcs [elab_options] [libname.]design_unit</p></blockquote><ul><li>libname<br>The library name where you analyzed your top module, entity, or the configuration.</li><li>design_unit<br><strong><em>design_unit</em></strong> is the same as in 4.2.</li></ul><h2 id="6-1-Commonly-Used-Options"><a href="#6-1-Commonly-Used-Options" class="headerlink" title="6.1 Commonly Used Options"></a>6.1 Commonly Used Options</h2><ul><li><p>-full64<br>Enables elaboration and simulation in 64-bit mode.</p></li><li><p>-file filename<br>Specifies a file containing elaboration options.</p></li><li><p>-R<br>Runs the executable file immediately after VCS links it together.</p></li><li><p>-j[number_of_processes]<br>by specifying the number of parallel processes VCS can launch for the native code generation phase of the compilation/elaboration.</p></li></ul><h2 id="6-2-Debug-Mode-Options"><a href="#6-2-Debug-Mode-Options" class="headerlink" title="6.2 Debug Mode Options"></a>6.2 Debug Mode Options</h2><p><strong><em>some examples:</em></strong><br>Compiling/Elaborating the Design in the Partial Debug Read Mode</p><blockquote><p>% vcs -debug_access+r [compile_options] TOP.v</p></blockquote><p>Compiling/Elaborating the Design in the Full Debug Mode</p><blockquote><p>% vcs -debug_access+all [compile_options] TOP.v</p></blockquote><p>Compiling/Elaborating the Design With the Desired Debug Capability</p><blockquote><p>% vcs -debug_access&lt;+options&gt; [compile_options] TOP.v</p></blockquote><p>Commonly used options of <strong><em>-debug_access[+option]</em></strong></p><ul><li>+r<br>This option enables the read capability for the entire design. This is the minimum debug option to invoke the Verdi interactive mode.</li><li>+w<br>This option applies write (deposit) capability to the registers and variables for the entire design.</li><li>+f<br>This option enables the following:<br>• Read capability on registers, variables, and nets<br>• Write (deposit) capability on registers and variables<br>• Force capability on registers, variables, and nets<br>This option is equivalent to -debug_access+r+w+fn+f</li><li>+drivers<br>This option enables driver debugging capability.<br>This option is equivalent to -debug_access+r+drivers.</li><li>+reverse<br>This option enables the reverse debugging feature.</li><li>+pp<br>This option enables write capability on registers and variables, callbacks for<br>the entire design, driver capability, and assertion debug capability.<br>This option is equivalent to: -debug_access+w+cbk+drivers</li></ul><h1 id="7-Obtaining-Consumption-of-CPU-Resources"><a href="#7-Obtaining-Consumption-of-CPU-Resources" class="headerlink" title="7. Obtaining Consumption of CPU Resources"></a>7. Obtaining Consumption of CPU Resources</h1><p>Specify -reportstats option at compile time as well as runtime or both depending on your requirement.</p><blockquote><p>%vcs -reportstats<br>%simv -reportstats</p></blockquote><p>When specifying this option at compile time, VCS prints out the following information.</p><p>Compilation Performance Summary:</p><blockquote><p>vcs started at: Mon Jan 01 1:02:03 2005<br>Elapsed time: 5 sec<br>CPU Time: 3.0 sec<br>Virtual memory size: 12 MB<br>Resident set size: 113 MB<br>Shared memory size: 65 MB<br>Private memory size: 63 MB<br>Major page faults: 0</p></blockquote><p>Simulation Performance Summary:</p><blockquote><p>Simulation started at : Mon Jan 01 1:02:03 2005<br>Elapsed Time: 1 sec<br>CPU Time: 0.1 sec<br>Virtual memory size: 150 MB<br>Resident set size: 100 MB<br>Shared memory size: 20 MB<br>Private memory size: 83.7 MB<br>Major page faults: 0</p></blockquote></div><div><ul class="post-copyright"><li class="post-copyright-author"> <strong>Post author:</strong> winter leaf</li><li class="post-copyright-link"> <strong>Post link:</strong> <a href="http://winter-leaf.github.io/VCS-use-note/" title="VCS use note">http://winter-leaf.github.io/VCS-use-note/</a></li><li class="post-copyright-license"> <strong>Copyright Notice:</strong> All articles in this blog are licensed under<a href="https://creativecommons.org/licenses/by-nc-sa/4.0/null" rel="noopener" target="_blank"><i class="fa fa-fw fa-creative-commons"></i> BY-NC-SA</a> unless stating additionally. Please indicate the source when reproduce.</li></ul></div><footer class="post-footer"><div class="post-tags"> <a href="/tags/setup/" rel="tag"># setup</a></div><div class="post-nav"><div class="post-nav-next post-nav-item"><a href="/matching-operators/" rel="next" title="match operators"><i class="fa fa-chevron-left"></i> match operators</a></div><span class="post-nav-divider"></span><div class="post-nav-prev post-nav-item"> <a href="/what-s-in-uvm-object-utils-begin-end/" rel="prev" title="what's in uvm_object_utils_begin/end">what's in uvm_object_utils_begin/end<i class="fa fa-chevron-right"></i></a></div></div></footer></article></div></div></div><div class="toggle sidebar-toggle"><span class="toggle-line toggle-line-first"></span><span class="toggle-line toggle-line-middle"></span><span class="toggle-line toggle-line-last"></span></div><aside class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc"> Table of Contents</li><li class="sidebar-nav-overview"> Overview</li></ul><div class="post-toc-wrap sidebar-panel"><div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#1-Analyzing-the-Design"><span class="nav-text">1. Analyzing the Design</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#2-Elaborating-the-Design"><span class="nav-text">2. Elaborating the Design</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#3-Simulating-the-Design"><span class="nav-text">3. Simulating the Design</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#4-Build-flow"><span class="nav-text">4. Build flow</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#4-1-Two-step-flow"><span class="nav-text">4.1 Two-step flow</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#compilation-Analyze-Elaborate"><span class="nav-text">compilation (Analyze + Elaborate)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Simulation"><span class="nav-text">Simulation</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-2-Three-step-flow"><span class="nav-text">4.2 Three-step flow</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-3-Default-Time-Unit-and-Time-Precision"><span class="nav-text">4.3 Default Time Unit and Time Precision</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#5-Commonly-used-options-in-analyze-step"><span class="nav-text">5. Commonly used options in analyze step</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#6-Commonly-used-options-in-elaboration-step"><span class="nav-text">6. Commonly used options in elaboration step</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#6-1-Commonly-Used-Options"><span class="nav-text">6.1 Commonly Used Options</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#6-2-Debug-Mode-Options"><span class="nav-text">6.2 Debug Mode Options</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#7-Obtaining-Consumption-of-CPU-Resources"><span class="nav-text">7. Obtaining Consumption of CPU Resources</span></a></li></ol></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"> <img class="site-author-image" itemprop="image" alt="winter leaf" src="/images/avatar.jpeg"><p class="site-author-name" itemprop="name">winter leaf</p><div class="site-description" itemprop="description">Batman, if you don't believe it then superman</div></div><div class="site-state-wrap motion-element"><nav class="site-state"><div class="site-state-item site-state-posts"> <a href="/archives/"><span class="site-state-item-count">31</span> <span class="site-state-item-name">posts</span></a></div><div class="site-state-item site-state-categories"> <span class="site-state-item-count">9</span> <span class="site-state-item-name">categories</span></div><div class="site-state-item site-state-tags"> <span class="site-state-item-count">15</span> <span class="site-state-item-name">tags</span></div></nav></div></div></div></aside><div id="sidebar-dimmer"></div></div></main><footer class="footer"><div class="footer-inner"><div class="copyright"> &copy; <span itemprop="copyrightYear">2021</span><span class="with-love"><i class="fa fa-gamepad"></i></span> <span class="author" itemprop="copyrightHolder">winter leaf</span></div></div></footer></div><script src="/lib/anime.min.js"></script><script src="/lib/velocity/velocity.min.js"></script><script src="/lib/velocity/velocity.ui.min.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/muse.js"></script><script src="/js/next-boot.js"></script><script src="/js/local-search.js"></script></body></html>